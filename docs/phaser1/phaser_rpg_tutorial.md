# Phaser.js RPG Tutorial: Building a Complete 2D Top-Down RPG Demo ## Table of Contents 1. [Introduction](#introduction) 2. [Prerequisites & Setup](#prerequisites--setup) 3. [Project Architecture](#project-architecture) 4. [Part 1: Game Foundation](#part-1-game-foundation) 5. [Part 2: The Player Character](#part-2-the-player-character) 6. [Part 3: The Tilemap](#part-3-the-tilemap) 7. [Part 4: NPCs and Interaction](#part-4-npcs-and-interaction) 8. [Part 5: UI and Polish](#part-5-ui-and-polish) 9. [Conclusion & Next Steps](#conclusion--next-steps) --- ## Introduction This tutorial teaches you how to build a fully functional 2D top-down RPG using **Phaser.js** (version 3.90.0) via CDN, without any build tools or frameworks. You'll create a game featuring: - **1 Protagonist** with animation and 8-directional movement - **1 NPC** with dialogue interaction - **A Small Tilemap** with collision detection - **A Simple UI** displaying player information - **Keyboard Controls** (WASD or Arrow keys) The style will match the pixel art aesthetic shown in the reference imageâ€”a cozy, top-down fantasy RPG with hand-drawn tiles and characters. ### Why Phaser.js? Phaser is ideal for 2D web games because it: - Provides robust 2D physics and collision detection - Handles sprite animation automatically - Includes comprehensive input management - Works on all modern browsers without installation - Is completely free and open-source --- ## Prerequisites & Setup ### What You Need 1. **A text editor** (VS Code, Notepad++, Sublime Text, or even Notepad) 2. **A web browser** (Chrome, Firefox, Safari, Edge) 3. **Basic JavaScript knowledge** (functions, objects, classes) 4. **Patience and curiosity** ### Project Structure Create the following folder structure: ``` rpg-game/ â”œâ”€â”€ index.html â”œâ”€â”€ js/ â”‚ â”œâ”€â”€ main.js â”‚ â”œâ”€â”€ player.js â”‚ â”œâ”€â”€ npc.js â”‚ â””â”€â”€ scene.js â”œâ”€â”€ assets/ â”‚ â”œâ”€â”€ images/ â”‚ â”‚ â”œâ”€â”€ tileset.png â”‚ â”‚ â”œâ”€â”€ player.png â”‚ â”‚ â””â”€â”€ npc.png â”‚ â””â”€â”€ data/ â”‚ â””â”€â”€ map.json ``` ### Getting Started 1. Create a folder called `rpg-game` on your computer 2. Inside, create subfolders: `js`, `assets/images`, and `assets/data` 3. Create an empty `index.html` file in the root --- ## Project Architecture Before diving into code, understand the architecture: ### Game Loop Phaser runs on a continuous game loop: ``` â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”� â”‚ preload() â”‚ â†� Load assets (images, sounds) â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â†“ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”� â”‚ create() â”‚ â†� Initialize game objects & setup â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â†“ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”� â”‚ update() â”‚ â†� Called every frame (~60 FPS) â”‚ - Input â”‚ Update positions, check collisions â”‚ - Physics â”‚ â”‚ - Logic â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ ``` ### Core Components 1. **Scene** - The stage where everything happens 2. **Sprites** - Visual game objects (player, NPC) 3. **Physics Bodies** - Invisible shapes for collision 4. **Animations** - Frame sequences for movement 5. **Input** - Keyboard/mouse handling 6. **Tilemap** - Grid-based level layout 7. **Text** - UI elements --- ## Part 1: Game Foundation ### Step 1.1: Create HTML Entry Point Create `index.html`: ```html <!DOCTYPE html> <html lang="en"> <head> <meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <title>Phaser RPG Demo</title> <style> body { margin: 0; padding: 0; display: flex; justify-content: center; align-items: center; min-height: 100vh; background: #1a1a1a; font-family: Arial, sans-serif; } #game-container { border: 3px solid #333; box-shadow: 0 0 20px rgba(0, 0, 0, 0.8); } #info-panel { position: absolute; top: 20px; left: 20px; background: rgba(0, 0, 0, 0.8); color: #fff; padding: 15px; border-radius: 5px; font-size: 14px; z-index: 100; } .stat-line { margin: 5px 0; } </style> </head> <body> <div id="game-container"></div> <div id="info-panel"> <div class="stat-line">Health: <span id="health">100</span>/100</div> <div class="stat-line">Position: (<span id="pos-x">0</span>, <span id="pos-y">0</span>)</div> <div class="stat-line">Dialogue: <span id="dialogue">None</span></div> <div class="stat-line" style="margin-top: 10px; font-size: 12px; color: #aaa;"> Press WASD or Arrow Keys to move<br> Press SPACE to interact </div> </div> <!-- Load Phaser from CDN --> <script src="https://cdn.jsdelivr.net/npm/phaser@3.90.0/dist/phaser.min.js"></script> <!-- Load game scripts --> <script src="js/scene.js"></script> <script src="js/player.js"></script> <script src="js/npc.js"></script> <script src="js/main.js"></script> </body> </html> ``` ### Step 1.2: Create Placeholder Assets For the MVP, we'll create 16x16 pixel art sprites programmatically using graphics. This eliminates the need for external image files initially. --- ## Part 2: The Player Character ### Step 2.1: Create Player Class Create `js/player.js`: ```javascript class Player extends Phaser.Physics.Arcade.Sprite { constructor(scene, x, y) { super(scene, x, y, 'player'); // Add to scene scene.add.existing(this); scene.physics.add.existing(this); // Physics properties this.body.setCollideWorldBounds(true); this.body.setBounce(0, 0); this.setScale(2); // Scale up small sprite // Movement this.moveSpeed = 200; this.velocityX = 0; this.velocityY = 0; this.currentDirection = 'down'; // down, up, left, right // Health this.health = 100; this.maxHealth = 100; // Input this.keys = scene.input.keyboard.addKeys({ up: Phaser.Input.Keyboard.KeyCodes.W, down: Phaser.Input.Keyboard.KeyCodes.S, left: Phaser.Input.Keyboard.KeyCodes.A, right: Phaser.Input.Keyboard.KeyCodes.D, interact: Phaser.Input.Keyboard.KeyCodes.SPACE, }); // Also support arrow keys const arrowKeys = scene.input.keyboard.addKeys({ up: Phaser.Input.Keyboard.KeyCodes.UP, down: Phaser.Input.Keyboard.KeyCodes.DOWN, left: Phaser.Input.Keyboard.KeyCodes.LEFT, right: Phaser.Input.Keyboard.KeyCodes.RIGHT, }); this.keys.up = this.keys.up || arrowKeys.up; this.keys.down = this.keys.down || arrowKeys.down; this.keys.left = this.keys.left || arrowKeys.left; this.keys.right = this.keys.right || arrowKeys.right; // Animation this.createAnimations(scene); } createAnimations(scene) { // Walking animations for each direction const directions = ['down', 'up', 'left', 'right']; directions.forEach(dir => { scene.anims.create({ key: `walk-${dir}`, frames: scene.anims.generateFrameNumbers('player', { start: this.getFrameStart(dir), end: this.getFrameEnd(dir) } ), frameRate: 8, repeat: -1 }); }); // Idle animation (single frame) scene.anims.create({ key: 'idle', frames: [{ key: 'player', frame: 0 }], frameRate: 1 }); this.play('idle'); } getFrameStart(direction) { const frameMap = { down: 0, up: 3, left: 6, right: 9 }; return frameMap[direction] || 0; } getFrameEnd(direction) { const frameMap = { down: 2, up: 5, left: 8, right: 11 }; return frameMap[direction] || 2; } update() { this.velocityX = 0; this.velocityY = 0; let isMoving = false; // Handle input if (this.keys.left.isDown) { this.velocityX = -this.moveSpeed; this.currentDirection = 'left'; isMoving = true; } else if (this.keys.right.isDown) { this.velocityX = this.moveSpeed; this.currentDirection = 'right'; isMoving = true; } if (this.keys.up.isDown) { this.velocityY = -this.moveSpeed; this.currentDirection = 'up'; isMoving = true; } else if (this.keys.down.isDown) { this.velocityY = this.moveSpeed; this.currentDirection = 'down'; isMoving = true; } // Apply velocity this.body.setVelocity(this.velocityX, this.velocityY); // Handle animation if (isMoving) { this.play(`walk-${this.currentDirection}`, true); } else { this.stop(); this.setFrame(this.getFrameStart(this.currentDirection)); } } takeDamage(amount) { this.health = Math.max(0, this.health - amount); } heal(amount) { this.health = Math.min(this.maxHealth, this.health + amount); } } ``` --- ## Part 3: The Tilemap ### Step 3.1: Create the Map Data Create `assets/data/map.json`: ```json { "compressionlevel": -1, "height": 10, "infinite": false, "layers": [ { "data": [ 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 1, 1, 3, 3, 3, 3, 3, 3, 1, 1, 1, 1, 1, 1, 2, 2, 1, 1, 3, 1, 1, 1, 3, 3, 1, 1, 1, 1, 1, 1, 2, 2, 1, 1, 3, 1, 1, 1, 3, 3, 1, 1, 1, 1, 1, 1, 2, 2, 1, 1, 3, 3, 3, 3, 3, 3, 1, 1, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2 ], "height": 10, "name": "Ground", "opacity": 1, "type": "tilelayer", "visible": true, "width": 16, "x": 0, "y": 0 } ], "nextlayerid": 2, "nextobjectid": 1, "orientation": "orthogonal", "renderorder": "right-down", "tiledversion": "1.10.1", "tileheight": 16, "tilesets": [ { "columns": 16, "firstgid": 1, "image": "tileset.png", "imageheight": 256, "imagewidth": 256, "margin": 0, "name": "tiles", "spacing": 0, "tilecount": 256, "tileheight": 16, "tilewidth": 16 } ], "tilewidth": 16, "type": "map", "version": "1.10" } ``` ### Step 3.2: Generate Tileset Programmatically We'll create the tileset on the fly. Add this to your `js/main.js` (shown in next section). --- ## Part 4: NPCs and Interaction ### Step 4.1: Create NPC Class Create `js/npc.js`: ```javascript class NPC extends Phaser.Physics.Arcade.Sprite { constructor(scene, x, y, name = 'NPC') { super(scene, x, y, 'npc'); scene.add.existing(this); scene.physics.add.existing(this); this.name = name; this.body.setImmovable(true); this.setScale(2); this.currentDirection = 'down'; // Dialogue this.dialogue = [ "Hello there, traveler!", "Welcome to our humble village.", "I am a simple NPC.", "I guard this area.", "Be careful of the monsters!" ]; this.currentDialogueIndex = 0; this.isInteracting = false; // Animation this.createAnimations(scene); this.play('npc-idle'); } createAnimations(scene) { scene.anims.create({ key: 'npc-idle', frames: scene.anims.generateFrameNumbers('npc', { start: 0, end: 0 }), frameRate: 1 }); } getNextDialogue() { const text = this.dialogue[this.currentDialogueIndex]; this.currentDialogueIndex = (this.currentDialogueIndex + 1) % this.dialogue.length; return text; } reset() { this.currentDialogueIndex = 0; this.isInteracting = false; } } ``` --- ## Part 5: The Scene ### Step 5.1: Create Game Scene Create `js/scene.js`: ```javascript class GameScene extends Phaser.Scene { constructor() { super({ key: 'GameScene' }); } preload() { // Create simple tileset programmatically this.createTileset(); // Create player sprite this.createPlayerSprite(); // Create NPC sprite this.createNPCSprite(); // Load map data (we'll create it inline) this.load.json('map', 'assets/data/map.json'); } create() { // Create the tilemap this.createMap(); // Create player this.player = new Player(this, 100, 100); // Create NPC this.npc = new NPC(this, 200, 150, 'Village Guard'); // Set up camera to follow player this.cameras.main.setBounds(0, 0, this.map.widthInPixels, this.map.heightInPixels); this.cameras.main.startFollow(this.player); // Set up collisions this.physics.add.collider(this.player, this.wallLayer); // Set up interaction this.physics.add.overlap(this.player, this.npc, () => this.handleNPCInteraction(), null, this); // Input for interaction this.input.keyboard.on('keydown-SPACE', () => { if (this.isPlayerNearNPC()) { this.showNextDialogue(); } }); // UI text this.setupUI(); // Game state this.dialogueText = null; } createTileset() { // Create a 16x16 tileset as graphics const graphics = this.make.graphics({ x: 0, y: 0, add: false }); graphics.fillStyle(0x228B22, 1); // Grass green graphics.fillRect(0, 0, 16, 16); // Tree tile graphics.fillStyle(0x8B4513, 1); // Brown graphics.fillRect(16, 0, 16, 16); // Water tile graphics.fillStyle(0x4169E1, 1); // Blue graphics.fillRect(32, 0, 16, 16); // Wall tile graphics.fillStyle(0x696969, 1); // Dark gray graphics.fillRect(48, 0, 16, 16); graphics.generateTexture('tileset', 64, 16); graphics.destroy(); } createPlayerSprite() { const graphics = this.make.graphics({ x: 0, y: 0, add: false }); // Create 4 walking frames + idle for 4 directions // Down: frames 0-2 graphics.fillStyle(0xFF6B6B, 1); // Red character for (let frame = 0; frame < 3; frame++) { graphics.fillRect(frame * 16, 0, 16, 16); } // Up: frames 3-5 graphics.fillRect(3 * 16, 0, 16, 16); graphics.fillRect(4 * 16, 0, 16, 16); graphics.fillRect(5 * 16, 0, 16, 16); // Left: frames 6-8 graphics.fillRect(6 * 16, 0, 16, 16); graphics.fillRect(7 * 16, 0, 16, 16); graphics.fillRect(8 * 16, 0, 16, 16); // Right: frames 9-11 graphics.fillRect(9 * 16, 0, 16, 16); graphics.fillRect(10 * 16, 0, 16, 16); graphics.fillRect(11 * 16, 0, 16, 16); graphics.generateTexture('player', 192, 16); graphics.destroy(); } createNPCSprite() { const graphics = this.make.graphics({ x: 0, y: 0, add: false }); // Simple NPC (blue character) graphics.fillStyle(0x4169E1, 1); // Blue NPC graphics.fillRect(0, 0, 16, 16); graphics.generateTexture('npc', 16, 16); graphics.destroy(); } createMap() { // Create tilemap from JSON this.map = this.make.tilemap({ key: 'map' }); const tileset = this.map.addTilesetImage('tiles', 'tileset'); // Create layer this.wallLayer = this.map.createLayer(0, tileset, 0, 0); // Set collision for walls (tiles with value 2 and 3) this.wallLayer.setCollisionByExclusion([-1, 0, 1]); // Collide with 2 and 3 } handleNPCInteraction() { // Interaction triggered when in range } isPlayerNearNPC() { const distance = Phaser.Math.Distance.Between( this.player.x, this.player.y, this.npc.x, this.npc.y ); return distance < 50; } showNextDialogue() { const text = this.npc.getNextDialogue(); // Show dialogue in UI document.getElementById('dialogue').textContent = `"${text}"`; // Also show as floating text above NPC if (this.dialogueText) { this.dialogueText.destroy(); } this.dialogueText = this.add.text( this.npc.x - 30, this.npc.y - 40, text, { fontSize: '12px', backgroundColor: '#000000', color: '#ffffff', padding: { x: 5, y: 5 }, wordWrap: { width: 80 } } ); this.dialogueText.setDepth(100); // Auto-dismiss after 3 seconds this.time.delayedCall(3000, () => { if (this.dialogueText) { this.dialogueText.destroy(); this.dialogueText = null; } document.getElementById('dialogue').textContent = 'None'; }); } setupUI() { // UI is handled in HTML, we'll update it in update() } update() { // Update player this.player.update(); // Update UI document.getElementById('health').textContent = this.player.health; document.getElementById('pos-x').textContent = Math.floor(this.player.x / 16); document.getElementById('pos-y').textContent = Math.floor(this.player.y / 16); // Check if out of bounds if (this.player.y > this.map.heightInPixels) { this.player.setPosition(100, 100); } } } ``` --- ## Part 6: Main Game Initialization ### Step 6.1: Create Main Configuration Create `js/main.js`: ```javascript // Game configuration const config = { type: Phaser.AUTO, width: 800, height: 600, parent: 'game-container', physics: { default: 'arcade', arcade: { gravity: { y: 0 }, debug: false // Set to true to see physics bodies } }, scene: [GameScene], render: { pixelArt: true, // Important for pixel art! antialias: false } }; // Create game instance const game = new Phaser.Game(config); ``` --- ## Part 7: Running Your Game ### Step 7.1: Start a Local Server Since loading JSON files requires a server, use one of these methods: **Using Python 3:** ```bash cd rpg-game python -m http.server 8000 ``` **Using Node.js:** ```bash cd rpg-game npx http-server ``` **Using VS Code:** Install the "Live Server" extension and right-click `index.html` â†’ "Open with Live Server" ### Step 7.2: Open in Browser Navigate to `http://localhost:8000` and you should see your RPG! --- ## Part 8: Game Features Explained ### Movement System The player uses WASD or Arrow keys to move in 8 directions. The `update()` method runs every frame (60 FPS) to handle: 1. Read keyboard input 2. Set velocity based on input 3. Play appropriate walking animation 4. Return to idle when no input ### Collision Detection Phaser's Arcade Physics handles collisions between: - **Player â†” Walls** (tilemap collision) - **Player â†” NPC** (overlap detection) The `setCollisionByExclusion()` method tells Phaser which tiles block movement. ### NPC Interaction When the player is within 50 pixels of an NPC and presses SPACE: 1. Get the next dialogue string from NPC's dialogue array 2. Display it as floating text and in UI 3. Auto-dismiss after 3 seconds 4. Cycle back to first dialogue when reaching the end ### Animation System Each direction has 3 frames of animation. The animation plays only when moving, and pauses when stationary. Phaser handles frame timing automatically based on `frameRate`. --- ## Part 9: Expanding Your Game ### Add More NPCs ```javascript // In GameScene.create() this.npc2 = new NPC(this, 350, 200, 'Town Mayor'); this.npc2.dialogue = [ "I run this town!", "Come back if you need help." ]; this.physics.add.overlap(this.player, this.npc2, () => {}, null, this); ``` ### Add Items/Collectibles ```javascript class Item extends Phaser.Physics.Arcade.Sprite { constructor(scene, x, y, type = 'potion') { super(scene, x, y, 'item'); scene.add.existing(this); scene.physics.add.existing(this); this.type = type; this.body.setImmovable(true); } } ``` ### Add Simple Enemy ```javascript class Enemy extends Phaser.Physics.Arcade.Sprite { constructor(scene, x, y) { super(scene, x, y, 'enemy'); scene.add.existing(this); scene.physics.add.existing(this); this.health = 10; this.speed = 100; this.setScale(2); } update(player) { // Simple chase behavior const distance = Phaser.Math.Distance.Between( this.x, this.y, player.x, player.y ); if (distance < 150) { const angle = Phaser.Math.Angle.Between( this.x, this.y, player.x, player.y ); this.body.setVelocity( Math.cos(angle) * this.speed, Math.sin(angle) * this.speed ); } else { this.body.setVelocity(0, 0); } } } ``` ### Create Proper Spritesheets Using a tool like **Aseprite**, **Piskel**, or even free online editors, create proper pixel art spritesheets. Then load them: ```javascript preload() { this.load.spritesheet('player', 'assets/images/player.png', { frameWidth: 16, frameHeight: 16 }); } ``` ### Add Sound Effects ```javascript preload() { this.load.audio('walk', 'assets/audio/footstep.wav'); this.load.audio('interact', 'assets/audio/confirm.wav'); } // In player update: if (isMoving && !this.walkingSound?.isPlaying) { this.walkingSound = this.scene.sound.play('walk'); } ``` ### Add Transitions Between Maps ```javascript // In GameScene enterNewMap(mapKey) { this.cameras.main.fadeOut(500); this.time.delayedCall(500, () => { this.scene.start(mapKey); }); } ``` --- ## Part 10: Best Practices ### Code Organization Keep your code modular: - **player.js** - All player logic - **npc.js** - NPC class - **enemy.js** - Enemy class - **scene.js** - Scene management - **main.js** - Game config and init ### Performance - **Use object pooling** for frequently created/destroyed objects - **Limit number of physics bodies** (50-100 is reasonable) - **Set physics debug to false** in production - **Use sprite atlases** instead of individual images ### Common Issues & Solutions | Issue | Solution | |-------|----------| | Player walks through walls | Check tilemap collision indices | | Animation doesn't play | Verify frame numbers match spritesheet | | Dialogue not showing | Ensure NPC is within range (50px) | | Performance drops | Reduce sprite count or physics bodies | | Input feels sluggish | Lower FPS cap or increase movement speed | --- ## Conclusion Congratulations! You've built a fully functional 2D RPG using Phaser.js. This foundation includes: âœ… Character movement and animation âœ… Tilemap with collision detection âœ… NPC interaction system âœ… Basic UI âœ… Keyboard input handling ### Next Steps to Level Up 1. **Add Combat System** - Implement attacking, damage, health loss 2. **Create Multiple Maps** - Use scene transitions to load new areas 3. **Add Inventory System** - Track items, equipment, consumables 4. **Implement Quest System** - Track NPC interactions and progression 5. **Add Music & Sound** - Use Phaser's audio system 6. **Polish Graphics** - Create or download proper pixel art assets 7. **Add Effects** - Particle systems, screen shake, lighting 8. **Deploy Online** - Upload to Itch.io, GitHub Pages, or your server ### Helpful Resources - **Official Phaser Docs**: https://docs.phaser.io - **Phaser Examples**: https://phaser.io/examples - **Free Assets**: https://itch.io (search "free tileset" or "free sprite") - **Pixel Art Tools**: Aseprite, Piskel, LibreSprite, GIMP - **Community**: Phaser Discourse, Stack Overflow, Reddit r/gamedev ### Key Concepts Learned 1. **Scene Life Cycle** - preload â†’ create â†’ update 2. **Physics & Collisions** - Bodies, overlaps, velocities 3. **Sprite Animation** - Frame sequences, animation states 4. **Input Handling** - Keyboard events and state checking 5. **Object-Oriented Design** - Classes extending Phaser sprites 6. **Game Architecture** - Separating concerns (player, NPC, scene) Happy game developing! ðŸŽ®âœ¨ --- **License**: This tutorial is free to use and modify. Phaser.js is released under the MIT license. 
